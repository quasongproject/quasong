import{r as c,a as V,j as e,L as R,H as W}from"./app-CTL60Ajj.js";const Q=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),U=s=>s.replace(/^([A-Z])|[\s-_]+(\w)/g,(a,t,o)=>o?o.toUpperCase():t.toLowerCase()),O=s=>{const a=U(s);return a.charAt(0).toUpperCase()+a.slice(1)},B=(...s)=>s.filter((a,t,o)=>!!a&&a.trim()!==""&&o.indexOf(a)===t).join(" ").trim(),q=s=>{for(const a in s)if(a.startsWith("aria-")||a==="role"||a==="title")return!0};var Z={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const J=c.forwardRef(({color:s="currentColor",size:a=24,strokeWidth:t=2,absoluteStrokeWidth:o,className:i="",children:n,iconNode:h,...f},d)=>c.createElement("svg",{ref:d,...Z,width:a,height:a,stroke:s,strokeWidth:o?Number(t)*24/Number(a):t,className:B("lucide",i),...!n&&!q(f)&&{"aria-hidden":"true"},...f},[...h.map(([u,m])=>c.createElement(u,m)),...Array.isArray(n)?n:[n]]));const y=(s,a)=>{const t=c.forwardRef(({className:o,...i},n)=>c.createElement(J,{ref:n,iconNode:a,className:B(`lucide-${Q(O(s))}`,`lucide-${s}`,o),...i}));return t.displayName=O(s),t};const X=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],G=y("heart",X);const Y=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],ee=y("house",Y);const se=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],te=y("pause",se);const ae=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],ne=y("play",ae);const ie=[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]],le=y("repeat",ie);const re=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],ce=y("search",re);const oe=[["path",{d:"m18 14 4 4-4 4",key:"10pe0f"}],["path",{d:"m18 2 4 4-4 4",key:"pucp1d"}],["path",{d:"M2 18h1.973a4 4 0 0 0 3.3-1.7l5.454-8.6a4 4 0 0 1 3.3-1.7H22",key:"1ailkh"}],["path",{d:"M2 6h1.972a4 4 0 0 1 3.6 2.2",key:"km57vx"}],["path",{d:"M22 18h-6.041a4 4 0 0 1-3.3-1.8l-.359-.45",key:"os18l9"}]],de=y("shuffle",oe);const he=[["path",{d:"M17.971 4.285A2 2 0 0 1 21 6v12a2 2 0 0 1-3.029 1.715l-9.997-5.998a2 2 0 0 1-.003-3.432z",key:"15892j"}],["path",{d:"M3 20V4",key:"1ptbpl"}]],ue=y("skip-back",he);const me=[["path",{d:"M21 4v16",key:"7j8fe9"}],["path",{d:"M6.029 4.285A2 2 0 0 0 3 6v12a2 2 0 0 0 3.029 1.715l9.997-5.998a2 2 0 0 0 .003-3.432z",key:"zs4d6"}]],pe=y("skip-forward",me);const xe=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],je=y("star",xe);const fe=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],ve=y("volume-2",fe),Ne=({onSearch:s,searchQuery:a})=>{const{auth:t}=V().props,o=!!t?.user,[i,n]=c.useState(a);c.useEffect(()=>{n(a)},[a]);const h=u=>{n(u.target.value)},f=u=>{u.key==="Enter"&&(s&&s(i),u.preventDefault())},d=()=>{s&&s(i)};return e.jsxs("header",{className:"header",children:[e.jsx(R,{className:"logo"}),e.jsx("div",{className:"search-container",children:e.jsxs("div",{className:"search-input-wrapper",children:[e.jsx(ce,{className:"search-icon",onClick:d}),e.jsx("input",{type:"text",placeholder:"What do you want to play?",className:"search-input",value:i,onChange:h,onKeyDown:f})]})}),e.jsx("div",{className:"auth-buttons",children:o?e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"user-name",children:["Hi, ",t.user.name]}),e.jsx(R,{href:"/logout",method:"post",as:"button",className:"logout-btn",children:"Logout"})]}):e.jsxs(e.Fragment,{children:[e.jsx(R,{href:"/login",className:"login-btn",children:"Sign In"}),e.jsx(R,{href:"/register",className:"signup-btn",children:"Sign Up"})]})})]})},ke=({activeMenu:s,setActiveMenu:a,onResetSearch:t})=>{const o=()=>{t&&t(),a("home")};return e.jsxs("nav",{className:"nav",children:[e.jsxs("button",{onClick:o,className:`nav-button ${s==="home"?"nav-button-active":""}`,children:[e.jsx(ee,{className:"nav-icon"}),"Home"]}),e.jsxs("button",{onClick:()=>a("favorite"),className:`nav-button ${s==="favorite"?"nav-button-active":""}`,children:[e.jsx(je,{className:"nav-icon"}),"Favorite"]})]})},ge=({songs:s,onPickSong:a,searchQuery:t})=>{const o=t&&t.trim().length>0,i=[{src:"/images/tb.jpg",alt:"quasong"}],[n,h]=c.useState(0),f=()=>h(m=>m===0?i.length-1:m-1),d=()=>h(m=>(m+1)%i.length),u=m=>h(m);return e.jsxs(e.Fragment,{children:[!o&&e.jsxs("div",{id:"carouselExampleIndicators",className:"carousel slide",children:[e.jsx("div",{className:"carousel-indicators",children:i.map((m,p)=>e.jsx("button",{type:"button",onClick:()=>u(p),className:n===p?"active":"","aria-current":n===p?"true":"false","aria-label":`Slide ${p+1}`},p))}),e.jsx("div",{className:"carousel-inner",children:i.map((m,p)=>e.jsx("div",{className:`carousel-item ${n===p?"active":""}`,children:e.jsx("img",{src:m.src,className:"d-block w-100",alt:m.alt})},p))}),e.jsxs("button",{className:"carousel-control-prev",type:"button",onClick:f,children:[e.jsx("span",{className:"carousel-control-prev-icon","aria-hidden":"true"}),e.jsx("span",{className:"visually-hidden",children:"Previous"})]}),e.jsxs("button",{className:"carousel-control-next",type:"button",onClick:d,children:[e.jsx("span",{className:"carousel-control-next-icon","aria-hidden":"true"}),e.jsx("span",{className:"visually-hidden",children:"Next"})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"recommendations-title",children:"Rekomendasi"}),e.jsxs("div",{className:"recommendations-grid",children:[s.map((m,p)=>e.jsxs("div",{className:"recommendation-item",onClick:()=>a(p,s),children:[e.jsx("img",{src:m.image,alt:m.title,className:"recommendation-image"}),e.jsxs("div",{className:"recommendation-info",children:[e.jsx("h3",{className:"recommendation-title",children:m.title}),e.jsx("p",{className:"recommendation-artist",children:m.artist})]})]},m.id||p)),s.length===0&&o&&e.jsxs("p",{style:{color:"#aaa",marginTop:"10px"},children:['Tidak ditemukan hasil untuk "',t,'"']})]})]})]})},ye=({songs:s=[],onPickSong:a})=>{const t=c.useMemo(()=>s.filter(n=>n.isLiked).sort((n,h)=>{const f=n.likedAt?new Date(n.likedAt).getTime():0;return(h.likedAt?new Date(h.likedAt).getTime():0)-f}),[s]),o=n=>{a&&t.length&&a(n,t)},i=n=>n?new Date(n).toLocaleDateString():"-";return e.jsxs("section",{className:"favorite-page",children:[e.jsxs("header",{className:"favorite-header",children:[e.jsx("div",{className:"playlist-cover-art",children:e.jsx(G,{className:"icon",strokeWidth:1})}),e.jsxs("div",{className:"playlist-details",children:[e.jsx("span",{className:"playlist-type",children:"Playlist"}),e.jsx("span",{className:"playlist-title",children:"Favorite"}),e.jsxs("span",{className:"playlist-song-count",children:[t.length," songs"]})]})]}),e.jsxs("div",{className:"song-list-container",children:[e.jsxs("div",{className:"song-list-header",children:[e.jsx("div",{className:"song-number",children:"No"}),e.jsx("div",{children:"Title"}),e.jsx("div",{children:"Date added"})]}),t.length===0&&e.jsxs("div",{className:"song-row",children:[e.jsx("div",{className:"song-number",children:"-"}),e.jsx("div",{className:"song-title-cell",children:e.jsxs("div",{className:"song-info",children:[e.jsx("div",{className:"title",children:"Belum ada lagu favorit"}),e.jsx("div",{className:"artist",children:"Like beberapa lagu dulu di halaman Home."})]})}),e.jsx("div",{className:"song-date-added",children:"-"})]}),t.map((n,h)=>e.jsxs("div",{className:"song-row",children:[e.jsx("div",{className:"song-number",children:h+1}),e.jsxs("div",{className:"song-title-cell",onClick:()=>o(h),style:{cursor:"pointer"},children:[e.jsx("img",{src:n.image,alt:n.title}),e.jsxs("div",{className:"song-info",children:[e.jsx("div",{className:"title",children:n.title}),e.jsx("div",{className:"artist",children:n.artist})]})]}),e.jsx("div",{className:"song-date-added",children:i(n.likedAt)})]},n.id))]})]})},be=({activeMenu:s,songs:a,onPickSong:t,searchQuery:o})=>s==="favorite"?e.jsx(ye,{songs:a,onPickSong:t}):e.jsx(ge,{songs:a,onPickSong:t,searchQuery:o}),Ce=({currentSong:s})=>e.jsx("div",{className:"song-details",children:e.jsxs("div",{className:"song-info-center",children:[e.jsx("h3",{className:"current-song-title",children:s?.title||"Judul Lagu"}),e.jsx("p",{className:"current-song-artist",children:s?.artist||"Penyanyi"}),e.jsx("div",{className:"current-song-image-container",children:e.jsx("img",{src:s?.image,alt:s?.title||"Current Song",className:"current-song-image"})}),e.jsxs("div",{className:"lyrics-container",children:[e.jsx("h4",{className:"lyrics-title",children:"Lyrics"}),e.jsx("div",{className:"lyrics-content",children:s?.lyrics})]})]})}),we=({currentSong:s,activeMenu:a,setActiveMenu:t,currentTime:o,songs:i,onPickSong:n,onResetSearch:h,searchQuery:f})=>e.jsxs("div",{className:"main-layout",children:[e.jsx("aside",{className:"sidebar",children:e.jsx(ke,{activeMenu:a,setActiveMenu:t,onResetSearch:h})}),e.jsx("main",{className:"main-content",children:e.jsx(be,{activeMenu:a,songs:i,onPickSong:n,searchQuery:f})}),e.jsx("aside",{className:"right-sidebar",children:e.jsx(Ce,{currentSong:s,currentTime:o})})]});function Le({currentSong:s,isPlaying:a,setIsPlaying:t,onTimeUpdate:o,onEnded:i,nextSong:n,prevSong:h,onLikeToggle:f,isShuffle:d=!1,repeatMode:u="none",toggleShuffle:m,toggleRepeat:p,onShuffleNext:w}){const N=c.useRef(null),[$,k]=c.useState(0),[L,z]=c.useState(0),[E,H]=c.useState(1),[A,M]=c.useState(!1);c.useEffect(()=>{const l=N.current;l&&(l.load(),l.volume=E,a&&l.play().catch(()=>t(!1)))},[s?.src]),c.useEffect(()=>{const l=N.current;l&&(a?l.play().catch(()=>t(!1)):l.pause())},[a]),c.useEffect(()=>{const l=N.current;if(!l)return;const v=()=>{k(l.currentTime),o?.(l.currentTime)},C=()=>z(l.duration||0),T=()=>{if(u==="one"){l.currentTime=0,l.play().then(()=>t(!0)).catch(()=>t(!1));return}if(d){typeof w=="function"?w():i?.();return}i?.()};return l.addEventListener("timeupdate",v),l.addEventListener("loadedmetadata",C),l.addEventListener("ended",T),()=>{l.removeEventListener("timeupdate",v),l.removeEventListener("loadedmetadata",C),l.removeEventListener("ended",T)}},[o,i,d,u,w]);const I=()=>{const l=N.current;l&&(a?(l.pause(),t(!1)):l.play().then(()=>t(!0)).catch(()=>t(!1)))},F=l=>{const v=Number(l.target.value),C=N.current;C&&(C.currentTime=v,k(v),o?.(v))},D=l=>{const v=Number(l.target.value);H(v),N.current&&(N.current.volume=v)},S=async()=>{if(!(!s||A)){M(!0);try{await f(s.id)}finally{M(!1)}}},_=l=>{if(!l||isNaN(l))return"0:00";const v=Math.floor(l/60),C=Math.floor(l%60).toString().padStart(2,"0");return`${v}:${C}`};return s?e.jsxs("div",{className:"player-container",children:[e.jsx(W,{title:"Quasong"}),e.jsx("audio",{ref:N,src:s.src,preload:"metadata"}),e.jsxs("div",{className:"player-info",children:[e.jsx("img",{src:s.image,alt:s.title}),e.jsxs("div",{children:[e.jsx("h4",{children:s.title}),e.jsx("p",{children:s.artist})]}),e.jsxs("button",{className:`like-button ${s.isLiked?"liked":""} ${A?"liking":""}`,onClick:S,disabled:A,title:s.isLiked?"Unlike":"Like",children:[e.jsx("svg",{className:"heart-icon",viewBox:"0 0 24 24",width:"20",height:"20",children:e.jsx("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})}),s.likesCount>0&&e.jsx("span",{className:"like-count",children:s.likesCount})]})]}),e.jsxs("div",{className:"player-center",children:[e.jsxs("div",{className:"player-controls",children:[e.jsx("button",{onClick:h,children:e.jsx(ue,{size:20})}),e.jsx("button",{onClick:I,children:a?e.jsx(te,{size:24}):e.jsx(ne,{size:24})}),e.jsx("button",{onClick:n,children:e.jsx(pe,{size:20})})]}),e.jsxs("div",{className:"player-progress",children:[e.jsx("span",{children:_($)}),e.jsx("input",{type:"range",min:"0",max:L||0,value:$,onChange:F}),e.jsx("span",{children:_(L)})]})]}),e.jsxs("div",{className:"player-options",children:[e.jsxs("div",{className:"extra-controls",children:[e.jsx("button",{className:`btn-icon shuffle-btn ${d?"active":""}`,title:d?"Shuffle: On":"Shuffle: Off",onClick:()=>m?.(),children:e.jsx(de,{size:18})}),e.jsx("button",{className:`btn-icon repeat-btn ${u!=="none"?"active":""} ${u==="one"?"repeat-one":""}`,title:u==="one"?"Repeat: One":u==="all"?"Repeat: All":"Repeat: Off",onClick:()=>p?.(),children:e.jsx(le,{size:18})})]}),e.jsxs("div",{className:"volume-control",children:[e.jsx(ve,{size:18}),e.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:E,onChange:D})]})]})]}):e.jsx("div",{className:"player-container",children:e.jsx("p",{children:"Tidak ada lagu dipilih ðŸŽµ"})})}function Me({auth:s,songs:a=[]}){const[t,o]=c.useState(Array.isArray(a)?a:[]),[i,n]=c.useState([]),[h,f]=c.useState(""),[d,u]=c.useState(null),[m,p]=c.useState(!1),[w,N]=c.useState("home"),[$,k]=c.useState(0),[L,z]=c.useState(!1),[E,H]=c.useState("none"),A=c.useMemo(()=>{const r=Array.isArray(t)?t:[],x=h.trim().toLowerCase();return x===""?r:r.filter(j=>{const g=(j.title||"").toLowerCase(),b=(j.artist||"").toLowerCase();return g.includes(x)||b.includes(x)})},[t,h]),M=c.useMemo(()=>t.find(r=>r.id===d)||null,[t,d]);c.useEffect(()=>{if(t.length>0&&i.length===0){const r=t.map(x=>x.id);n(r),d||u(r[0])}},[t,i.length,d]),c.useEffect(()=>{t.length===0&&(p(!1),k(0),u(null),n([]))},[t.length]);const I=r=>{f(r),N("home")},F=()=>{f("")},D=(r,x)=>{if(!x||!x.length)return;const j=r<0||r>=x.length?0:r,g=x.map(K=>K.id),b=x[j];n(g),u(b.id),p(!0),k(0)},S=i.length>0,_=()=>{if(!S||!d)return;if(L&&i.length>1){let j=0,g=d;for(;g===d&&j<10;){const b=Math.floor(Math.random()*i.length);g=i[b],j+=1}if(g&&g!==d){u(g),p(!0),k(0);return}}const r=i.indexOf(d);if(r===-1)return;const x=i[(r+1)%i.length];u(x),p(!0),k(0)},l=()=>{if(!S||!d)return;const r=i.indexOf(d);if(r===-1)return;const x=(r-1+i.length)%i.length,j=i[x];u(j),p(!0),k(0)},v=()=>{if(!S||!d)return;if(i.length<=1){p(!0),k(0);return}let r=d,x=0;for(;r===d&&x<10;){const j=Math.floor(Math.random()*i.length);r=i[j],x+=1}r&&r!==d&&(u(r),p(!0),k(0))},C=()=>z(r=>!r),T=()=>{H(r=>r==="none"?"all":r==="all"?"one":"none")},P=async r=>{try{const j=await(await fetch(`/music/${r}/toggle-like`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.content||""}})).json();j.success?o(g=>g.map(b=>b.id===r?{...b,isLiked:j.isLiked,likesCount:j.likesCount,likedAt:j.likedAt??b.likedAt}:b)):console.error("Failed to toggle like:",j.message)}catch(x){console.error("Error toggling like:",x)}};return e.jsxs("div",{className:"App",children:[e.jsx(Ne,{onSearch:I,searchQuery:h}),e.jsx(we,{currentSong:M,setActiveMenu:N,activeMenu:w,currentTime:$,songs:A,onPickSong:D,onResetSearch:F,searchQuery:h}),e.jsx(Le,{currentSong:M,isPlaying:m,setIsPlaying:p,onTimeUpdate:k,onEnded:_,nextSong:_,prevSong:l,onLikeToggle:P,isShuffle:L,repeatMode:E,toggleShuffle:C,toggleRepeat:T,onShuffleNext:v})]})}export{Me as default};
